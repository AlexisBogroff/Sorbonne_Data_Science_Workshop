\input{CM_class.tex}
\begin{document}

\begin{frame}
   \titlepage
\end{frame}

\input{CM_introduction.tex}

\begin{frame}
   \tableofcontents
\end{frame}

% =============================================================================
% =============================================================================
\section{Predictions}
% 3 Hours course
% =============================================================================
% =============================================================================


%------------------------------------------------------------------------------
\subsection{Predictions: What does that mean?}
%------------------------------------------------------------------------------
% Use cases

% TODO: add "supervised learning" to first slides until unsupervised section
% TODO: add slide explaining difference between supervised and unsupervised learning

\begin{frame}\frametitle{Predictions: What does that mean?}
   What is modeled?
   \vspace{.3cm}
   \begin{itemize}
      \item Continuity (stationarity)
      \item Correlation (pattern)
   \end{itemize}
   \begin{minipage}{0.60\linewidth}
      \begin{figure}[H]
         \includegraphics[scale=.4]{../images/illustrations/model_pattern.png}
      \end{figure}
   \end{minipage}
\end{frame}


\begin{frame}\frametitle{Predictions: What does that mean?}
   What is modeled?
   \vspace{.5cm}
   \begin{itemize}
      \item Correlation vs Causality\footnote{\href{Spurious correlations site}{https://www.tylervigen.com/spurious-correlations}}
   \end{itemize}
   \begin{minipage}{0.60\linewidth}
      \begin{figure}[H]
         \includegraphics[scale=.15]{../images/illustrations/model_spurious_correlation.png}
      \end{figure}
   \end{minipage}
\end{frame}


\begin{frame}\frametitle{Predictions: Examples}
   \begin{itemize}
      \item Present:
      \begin{itemize}
         \item Electricity consumption based on other cities (e.g. Seattle)
         \item Missing values (interpolation, extrapolation)
         \item Client category
         \begin{minipage}{0.6\linewidth}
            \begin{figure}[H]
               \includegraphics[scale=.1]{../images/illustrations/model_client.png}
            \end{figure}
         \end{minipage}
      \end{itemize}
      \item Future:
      \begin{itemize}
         \item Electricity consumption next month (time series)
         \begin{minipage}{0.60\linewidth}
            \begin{figure}[H]
               \includegraphics[scale=.35]{../images/illustrations/model_electricity.jpg}
            \end{figure}
         \end{minipage}
         \item Client clicking add (recommander sys.)
         \item Pedestrian and cars trajectories (RL)
      \end{itemize}
   \end{itemize}
   % TODO: add graph with predictions
\end{frame}


%------------------------------------------------------------------------------
\subsection{Supervised ML}
%------------------------------------------------------------------------------

\subsubsection{Regression}


\begin{frame}\frametitle{Regression}
   \begin{itemize}
      \item Linear regression
      \item Simple: $Y = aX + b$
      \item Multiple: $Y = a_1X_1 + a_2X_2 + \dots + a_nX_n + b$
   \end{itemize}

   \begin{figure}[H]
      \includegraphics[scale=.35]{../images/illustrations/model_linear_regression.png}
   \end{figure}
\end{frame}


\begin{frame}\frametitle{Regression}
   \begin{itemize}
      \item Polynomial regression
      \item Simple: $Y = a_1X + a_2X^2 + \dots + a_nX^n +b$
      \item Multiple: $$Y = a_{11}X_1 + a_{21}X_2 + a_{n1}X_n + a_{12}X_1^2 + a_{22}X_2^2 + a_{n2}X_n^2 + $$
                           $$\dots + a_{1m}X_1^m + a_{2m}X_2^m + a_{nm}X_n^m + b$$
   \end{itemize}
   \begin{figure}[H]
      \includegraphics[scale=.35]{../images/illustrations/model_polynomial_regression.png}
   \end{figure}
\end{frame}


\begin{frame}\frametitle{Regression}
   \begin{itemize}
      \item Fight multicolinearity
      \begin{itemize}
         \item Ridge: lower weights
         \item Lasso: set weights to zero
         \item Elastic Net: combine both
      \end{itemize}
   \end{itemize}
   \begin{figure}[H]
      \includegraphics[scale=.23]{../images/illustrations/model_ridge_lasso.png}
   \end{figure}
\end{frame}


\begin{frame}\frametitle{Regression}
   \begin{itemize}
      \item SARIMA: seasonal, auto-regressive, integrated, moving average
      \item Parametric model that capture patterns like:
      \begin{itemize}
         \item Trend
         \item Cycle
         \item Season
      \end{itemize}
   \end{itemize}
\end{frame}


\begin{frame}\frametitle{Regression}
   \begin{itemize}
      \item Deep Learning (RNN, LSTM)
   \end{itemize}
   \begin{figure}[H]
      \includegraphics[scale=.35]{../images/illustrations/model_rnn.png}
   \end{figure}
   \begin{figure}[H]
      \includegraphics[scale=.35]{../images/illustrations/model_lstm.png}
   \end{figure}
\end{frame}


\subsubsection{Classification}

\begin{frame}\frametitle{Classification}
   \begin{itemize}
      \item Logistic regression
      $\frac{1}{1 + e^{-z}}$ with \textit{z} linear (polynomial) regression
      \begin{figure}[H]
         \includegraphics[scale=.35]{../images/illustrations/model_logistic_regression.png}
      \end{figure}
      \begin{figure}[H]
         \includegraphics[scale=.2]{../images/illustrations/model_logistic_regression_example.png}
      \end{figure}
   \end{itemize}
\end{frame}


\begin{frame}\frametitle{Classification}
   \begin{itemize}
      \item Tree (ensemble models, RF, XGBoost)
      \begin{figure}[H]
         \includegraphics[scale=.35]{../images/illustrations/model_tree.png}
      \end{figure}
      \begin{figure}[H]
         \includegraphics[scale=.35]{../images/illustrations/model_tree_example.png}
      \end{figure}
   \end{itemize}
\end{frame}



\begin{frame}\frametitle{Classification}
   \begin{itemize}
      \item K-means
      \begin{itemize}
         \item Positionnement
      \end{itemize}
      \begin{enumerate}
         \item Capture (iter 1)
         \item Recentrage (iter 2)
      \end{enumerate}
      \begin{figure}[H]
         \includegraphics[scale=.35]{../images/illustrations/model_kmeans.png}
      \end{figure}
   \end{itemize}
\end{frame}


\begin{frame}\frametitle{Classification}
   \begin{itemize}
      \item Neural Network (Deep Learning: CNN)\footnote{\href{https://playground.tensorflow.org/}{https://playground.tensorflow.org/}}
      \begin{figure}[H]
         \includegraphics[scale=.25]{../images/illustrations/model_neural_network.png}
      \end{figure}
      
      \item Gradient descent
      \begin{figure}[H]
         \includegraphics[scale=.14]{../images/illustrations/model_optimization_gradient_descent.jpeg}
      \end{figure}
   \end{itemize}
\end{frame}


%------------------------------------------------------------------------------
\subsection{Unsupervised ML}
%------------------------------------------------------------------------------

\begin{frame}\frametitle{Unsupervised ML}
   \begin{itemize}
      \item Tasks
      \begin{itemize}
         \item Clustering (grouping)
         \item Dimensionality reduction
      \end{itemize}
   \end{itemize}
   \begin{figure}[H]
      \includegraphics[scale=.35]{../images/illustrations/model_dimension_reduction.png}
   \end{figure}
\end{frame}


\begin{frame}\frametitle{Unsupervised ML}
   \begin{itemize}
      \item Models
      \begin{itemize}
         \item Knn: entropy minimisation principle\\
         (min var intraclass, max var interclass)
         \item Hierarchical Clustering (dendrogram)
      \end{itemize}
   \end{itemize}
   \begin{figure}[H]
      \includegraphics[scale=.18]{../images/illustrations/model_hierarchical_clustering.png}
   \end{figure}

\end{frame}


\begin{frame}\frametitle{Unsupervised ML}
   \begin{itemize}
      \item Models
      \begin{itemize}
         \item PCA
      \end{itemize}
   \end{itemize}
   \begin{figure}[H]
      \includegraphics[scale=.12]{../images/illustrations/model_pca_graphs.png}
   \end{figure}
\end{frame}




%------------------------------------------------------------------------------
\subsection{Optimizing models}
%------------------------------------------------------------------------------

\begin{frame}\frametitle{Optimizing models - Control fit}
   \begin{itemize}
      \item Objective: generalization, i.e. good performance on out-of-sample data
      \item Control over/under-fitting
   \end{itemize}
   \begin{figure}[H]
      \includegraphics[scale=.25]{../images/illustrations/model_fit.png}
   \end{figure}
\end{frame}

\begin{frame}\frametitle{Optimizing models - Control fit}
   \begin{itemize}
      \item Parameters
      \item Hyperparameters
      \item Train, cross-validate, test
   \end{itemize}
   \begin{figure}[H]
      \includegraphics[scale=.25]{../images/illustrations/model_split_data.png}
   \end{figure}
\end{frame}

\begin{frame}\frametitle{Optimizing models - Control fit}
   \begin{itemize}
      \item Feature importance
   \end{itemize}
   \begin{figure}[H]
      \includegraphics[scale=.25]{../images/illustrations/model_feature_importance.png}
   \end{figure}
\end{frame}



\begin{frame}\frametitle{Optimizing models - Issues}
   \begin{itemize}
      \item Multicolinearity
      \item Data Leakage: data not available at prediction time
      \begin{itemize}
         \item Using feature not available \textit{e.g. comments on an evaluation}
         \item Imputing NA train using average of whole data set
      \end{itemize}
      \item Unbalanced Datasets
      \begin{itemize}
         \item Weights on cost function
         \item SMOTE
         \item Auto-encoder
      \end{itemize}
   \end{itemize}
   \begin{figure}[H]
      \includegraphics[scale=.32]{../images/illustrations/model_unbalanced_dataset.png}
   \end{figure}
\end{frame}


\begin{frame}\frametitle{Metrics}
   \begin{minipage}{0.58\linewidth}
      \begin{itemize}
         \item Regression
         \begin{itemize}
            \item $RMSE = \sqrt{\sum_{i=1}^n{\frac{(\hat{y}_i-y_i)^2}{n}}}$
            \vspace{.2cm}
            \item $R^2 = \frac{SSR}{SST} = \frac{\sum(\hat{y}_i-\bar{y})^2}{\sum(y_i-\bar{y})^2}$
         \end{itemize}
      \end{itemize}
   \end{minipage}
   \begin{minipage}{0.38\linewidth}
      \begin{figure}[H]
         \includegraphics[scale=.37]{../images/illustrations/model_results_regression.png}
      \end{figure}
   \end{minipage}
   
   \vspace{.5cm}
   \begin{minipage}{0.58\linewidth}
      \begin{itemize}
         \item Classification      
         \begin{itemize}
            \item $Accuracy = \frac{TP + TN}{TP + TN + FP + FN}$
            \vspace{.2cm}
            \item AUC, ROC Curve
         \end{itemize}
      \end{itemize}
   \end{minipage}
   \begin{minipage}{0.38\linewidth}
      \begin{figure}[H]
         \includegraphics[scale=.37]{../images/illustrations/model_results_classification.png}
      \end{figure}
   \end{minipage}

   \vspace{.3cm}
   \hspace{.2cm}
   \begin{minipage}{0.48\linewidth}
      \begin{figure}[H]
         \includegraphics[scale=.17]{../images/illustrations/model_confusion_matrix.png}
      \end{figure}
   \end{minipage}
   \begin{minipage}{0.38\linewidth}
      \begin{figure}[H]
         \includegraphics[scale=.09]{../images/illustrations/model_roc_curve.png}
      \end{figure}
   \end{minipage}
\end{frame}


\begin{frame}\frametitle{Transfer Learning, Why?}
   \begin{itemize}
      \item Training can be complicated, long and expensive
      \item Specific but complex (and similar) task (NLP)
      \item Few samples (one shot, few shots learning)
   \end{itemize}
   
   \vspace{.3cm}
   \begin{minipage}{0.48\linewidth}
      \begin{figure}[H]
         \includegraphics[scale=.2]{../images/illustrations/model_transfer_learning.png}
      \end{figure}
   \end{minipage}
   \begin{minipage}{0.48\linewidth}
      \begin{figure}[H]
         \includegraphics[scale=.2]{../images/illustrations/model_multitask_learning.png}
      \end{figure}
   \end{minipage}
\end{frame}

\begin{frame}\frametitle{What has been learnt?}
   \begin{itemize}
      \item Weights value (or centroids)
      \item Hyperparameters
      \item Structure (genetic algorithms)
   \end{itemize}
   \begin{figure}[H]
      \includegraphics[scale=.2]{../images/illustrations/model_genetic_algorithms.png}
   \end{figure}
\end{frame}


\begin{frame}\frametitle{Transfer Learning, techniques}
   \begin{itemize}
      \item Optimize target objective through intermediate steps:
      \begin{itemize}
         \begin{minipage}{0.7\linewidth}
            \item Increase task difficulty gradually
            \begin{itemize}
               \item Classification: easy to subtile differences
               \item RL: e.g. \textit{Cartpole}
            \end{itemize}
         \end{minipage}
         \begin{minipage}{0.28\linewidth}
            \begin{figure}[H]
               \includegraphics[scale=.27]{../images/illustrations/model_cartpole.png}
            \end{figure}
         \end{minipage}
         % TODO: find cartople transfer learning simple to complex levels
   
         \item Learn other tasks
         \begin{itemize}
            \item Classification: learn unrelated objects
            \item RL: Multi-task learning
         \end{itemize}
         \item Improve Neural Network architecture (genetic algorithms)
      \end{itemize}
   \end{itemize}

   \vspace{.3cm}
   \begin{minipage}{0.38\linewidth}
      \begin{figure}[H]
         \includegraphics[scale=.09]{../images/illustrations/model_cat_dog.jpeg}
      \end{figure}
   \end{minipage}
   \begin{minipage}{0.38\linewidth}
      \begin{figure}[H]
         \includegraphics[scale=.2]{../images/illustrations/model_puppy_or_cookie.jpeg}
      \end{figure}
   \end{minipage}
\end{frame}


%------------------------------------------------------------------------------
\subsection{Some code examples}
%------------------------------------------------------------------------------

\begin{frame}\frametitle{Some code examples}
   \begin{itemize}
      \item Scikit-learn: train and predict using 4 lines of code

      \vspace{.3cm}
      \begin{figure}[H]
         \hspace*{-6cm}
         \includegraphics[scale=.4]{../images/illustrations/model_code_linear_regression.png}
      \end{figure}

      \begin{figure}[H]
         \hspace*{-3.76cm} 
         \includegraphics[scale=.4]{../images/illustrations/model_code_random_forest.png}
      \end{figure}
      
   \end{itemize}
\end{frame}


\begin{frame}\frametitle{Some code examples}
   \begin{itemize}
      \item Deep Learning with Pytorch\footnote{\href{https://pytorch.org/tutorials/beginner/pytorch_with_examples.html}{Pytorch API}} or Tensorflow\footnote{\href{https://www.tensorflow.org/api_docs/python/tf?hl=fr}{Tensorlow API}}
      \begin{itemize}
         \item See \href{https://colab.research.google.com/github/omarsar/pytorch_notebooks/blob/master/pytorch_quick_start.ipynb}{Pytroch example CNN for MNIST detection}
         \item Advantages: parallelize, automatic differenciation, and more
      \end{itemize}
   \end{itemize}

   \begin{figure}[H]
      \includegraphics[scale=.13]{../images/illustrations/model_pytorch_graph.png}
   \end{figure}

\end{frame}


\end{document}
